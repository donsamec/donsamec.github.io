<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Belonging Audit | Don Samec</title>
    <link rel="icon" type="image/jpeg" href="favicon.jpg">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.7;
            color: #2c2c2c;
            background: #f8f8f8;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 3rem 2rem;
            min-height: 100vh;
        }
        
        .quiz-card {
            background: white;
            border-radius: 8px;
            padding: 3rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        /* Progress Bar */
        .progress-container {
            margin-bottom: 2rem;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: #1a1a1a;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #666;
        }
        
        /* Landing Page */
        .landing {
            text-align: center;
        }
        
        .landing h1 {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            color: #1a1a1a;
        }
        
        .landing p {
            font-size: 1.2rem;
            color: #555;
            margin-bottom: 2rem;
            line-height: 1.8;
        }
        
        .start-button {
            background: #1a1a1a;
            color: white;
            padding: 1rem 3rem;
            border: none;
            border-radius: 4px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .start-button:hover {
            background: #333;
            transform: translateY(-2px);
        }
        
        /* Quiz Questions */
        .question-container {
            display: none;
        }
        
        .question-container.active {
            display: block;
        }
        
        .question-number {
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 0.5rem;
        }

        .question-category {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #888;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .question-text {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 2rem;
            color: #2c2c2c;
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .option {
            padding: 1.5rem;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .option:hover {
            border-color: #1a1a1a;
            background: #f8f8f8;
        }
        
        .option.selected {
            border-color: #1a1a1a;
            background: #f8f8f8;
        }
        
        .option-number {
            font-size: 1.2rem;
            font-weight: 700;
            color: #1a1a1a;
            min-width: 30px;
        }
        
        .option-text {
            flex: 1;
            font-size: 1rem;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            gap: 1rem;
        }
        
        .nav-button {
            padding: 0.75rem 2rem;
            border: 2px solid #1a1a1a;
            background: white;
            color: #1a1a1a;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .nav-button:hover {
            background: #1a1a1a;
            color: white;
        }
        
        .nav-button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .nav-button.primary {
            background: #1a1a1a;
            color: white;
        }
        
        .nav-button.primary:hover {
            background: #333;
        }
        
        /* Email Gate */
        .email-gate {
            display: none;
            text-align: center;
        }
        
        .email-gate.active {
            display: block;
        }
        
        .email-gate h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        
        .email-gate p {
            font-size: 1.1rem;
            color: #555;
            margin-bottom: 2rem;
        }
        
        .email-form {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .email-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            font-size: 1rem;
            margin-bottom: 1rem;
        }
        
        .email-input:focus {
            outline: none;
            border-color: #1a1a1a;
        }
        
        .submit-button {
            width: 100%;
            padding: 1rem;
            background: #1a1a1a;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .submit-button:hover {
            background: #333;
        }

        /* Loading State */
        .loading-container {
            text-align: center;
            padding: 3rem 2rem;
        }

        .loading-text {
            font-size: 1.2rem;
            color: #555;
            margin-bottom: 1.5rem;
            font-weight: 500;
        }

        .loading-bar {
            width: 100%;
            max-width: 400px;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin: 0 auto;
            overflow: hidden;
        }

        .loading-progress {
            height: 100%;
            background: #1a1a1a;
            width: 0%;
            animation: loadingProgress 2s ease-out forwards;
            border-radius: 4px;
        }

        @keyframes loadingProgress {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }

        /* Results */
        .results {
            display: none;
            text-align: center;
            opacity: 0;
            transition: opacity 0.6s ease-in-out;
        }

        .results.active {
            display: block;
        }

        .results.fade-in {
            opacity: 1;
        }
        
        .score-display {
            font-size: 4rem;
            font-weight: 700;
            color: #1a1a1a;
            margin: 2rem 0;
        }
        
        .score-label {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 2rem;
        }
        
        .results h2 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            color: #1a1a1a;
        }
        
        .results-content {
            text-align: left;
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 2rem;
        }
        
        .results-content p {
            margin-bottom: 1.5rem;
        }
        
        .results-content ul {
            margin: 1rem 0 1rem 2rem;
        }
        
        .results-content li {
            margin-bottom: 0.5rem;
        }
        
        .cta-box {
            background: #f8f8f8;
            padding: 2rem;
            border-radius: 8px;
            margin-top: 2rem;
        }
        
        .cta-box h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .contact-info {
            font-size: 1.1rem;
            color: #1a1a1a;
            margin-top: 1rem;
        }
        
        .home-link {
            display: inline-block;
            margin-top: 2rem;
            color: #1a1a1a;
            text-decoration: none;
            border-bottom: 2px solid #c44536;
            padding-bottom: 2px;
            font-weight: 600;
        }

        .pdf-button {
            padding: 1rem 2.5rem;
            border: 2px solid #1a1a1a;
            background: white;
            color: #1a1a1a;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
        }

        .pdf-button:hover {
            background: #f8f8f8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }


        @media (max-width: 768px) {
            .quiz-card {
                padding: 2rem 1.5rem;
            }
            
            .landing h1 {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.3rem;
            }
            
            .score-display {
                font-size: 3rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="quiz-card">
            <!-- Progress Bar -->
            <div class="progress-container" style="display: none;" id="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-text" id="progress-text">Section 1 of 5</div>
            </div>
            
            <!-- Landing Page -->
            <div class="landing" id="landing">
                <h1>The 2-Minute Belonging Audit</h1>
                <p>5 questions. 2 minutes. Find out if your space is helping or hurting.</p>
                <button class="start-button" onclick="startQuiz()">Start the Audit</button>
            </div>
            
            <!-- Question 1 -->
            <div class="question-container" id="q1">
                <div class="question-number">Section 1 of 5</div>
                <div class="question-category">Visual Depth</div>
                <div class="question-text">Does your space reveal new details on repeated viewing, or is it visually exhausted in one glance?</div>
                <div class="options">
                    <div class="option" onclick="selectAnswer(1, 1)">
                        <div class="option-number">1</div>
                        <div class="option-text">Visually exhausted immediately</div>
                    </div>
                    <div class="option" onclick="selectAnswer(1, 2)">
                        <div class="option-number">2</div>
                        <div class="option-text">Minimal visual interest</div>
                    </div>
                    <div class="option" onclick="selectAnswer(1, 3)">
                        <div class="option-number">3</div>
                        <div class="option-text">Some details, but forgettable</div>
                    </div>
                    <div class="option" onclick="selectAnswer(1, 4)">
                        <div class="option-number">4</div>
                        <div class="option-text">Interesting on repeated viewing</div>
                    </div>
                    <div class="option" onclick="selectAnswer(1, 5)">
                        <div class="option-number">5</div>
                        <div class="option-text">Reveals new details each time</div>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button class="nav-button" onclick="previousQuestion()" disabled>Previous</button>
                    <button class="nav-button primary" onclick="nextQuestion()" id="next-1" disabled>Next</button>
                </div>
            </div>
            
            <!-- Question 2 -->
            <div class="question-container" id="q2">
                <div class="question-number">Section 2 of 5</div>
                <div class="question-category">Sense of Place</div>
                <div class="question-text">Would a visitor know what city they're in based on this space alone?</div>
                <div class="options">
                    <div class="option" onclick="selectAnswer(2, 1)">
                        <div class="option-number">1</div>
                        <div class="option-text">Could be anywhere in the world</div>
                    </div>
                    <div class="option" onclick="selectAnswer(2, 2)">
                        <div class="option-number">2</div>
                        <div class="option-text">Generic with minimal local references</div>
                    </div>
                    <div class="option" onclick="selectAnswer(2, 3)">
                        <div class="option-number">3</div>
                        <div class="option-text">Some local elements present</div>
                    </div>
                    <div class="option" onclick="selectAnswer(2, 4)">
                        <div class="option-number">4</div>
                        <div class="option-text">Clear sense of location</div>
                    </div>
                    <div class="option" onclick="selectAnswer(2, 5)">
                        <div class="option-number">5</div>
                        <div class="option-text">Unmistakably reflects our city</div>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button class="nav-button" onclick="previousQuestion()">Previous</button>
                    <button class="nav-button primary" onclick="nextQuestion()" id="next-2" disabled>Next</button>
                </div>
            </div>
            
            <!-- Question 3 -->
            <div class="question-container" id="q3">
                <div class="question-number">Section 3 of 5</div>
                <div class="question-category">Emotional Temperature</div>
                <div class="question-text">How would you characterize the space — warm and inviting, or professional but cold?</div>
                <div class="options">
                    <div class="option" onclick="selectAnswer(3, 1)">
                        <div class="option-number">1</div>
                        <div class="option-text">Professional but cold</div>
                    </div>
                    <div class="option" onclick="selectAnswer(3, 2)">
                        <div class="option-number">2</div>
                        <div class="option-text">Functional, lacks warmth</div>
                    </div>
                    <div class="option" onclick="selectAnswer(3, 3)">
                        <div class="option-number">3</div>
                        <div class="option-text">Neutral, neither warm nor cold</div>
                    </div>
                    <div class="option" onclick="selectAnswer(3, 4)">
                        <div class="option-number">4</div>
                        <div class="option-text">Welcoming with some warmth</div>
                    </div>
                    <div class="option" onclick="selectAnswer(3, 5)">
                        <div class="option-number">5</div>
                        <div class="option-text">Inviting and warm</div>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button class="nav-button" onclick="previousQuestion()">Previous</button>
                    <button class="nav-button primary" onclick="nextQuestion()" id="next-3" disabled>Next</button>
                </div>
            </div>
            
            <!-- Question 4 -->
            <div class="question-container" id="q4">
                <div class="question-number">Section 4 of 5</div>
                <div class="question-category">Dwell Behavior</div>
                <div class="question-text">Do people pause and linger here, or treat it as a pass-through zone?</div>
                <div class="options">
                    <div class="option" onclick="selectAnswer(4, 1)">
                        <div class="option-number">1</div>
                        <div class="option-text">Pure pass-through, no one stops</div>
                    </div>
                    <div class="option" onclick="selectAnswer(4, 2)">
                        <div class="option-number">2</div>
                        <div class="option-text">Rare pausing, mostly transactional</div>
                    </div>
                    <div class="option" onclick="selectAnswer(4, 3)">
                        <div class="option-number">3</div>
                        <div class="option-text">Some lingering, but not designed for it</div>
                    </div>
                    <div class="option" onclick="selectAnswer(4, 4)">
                        <div class="option-number">4</div>
                        <div class="option-text">People often pause and engage</div>
                    </div>
                    <div class="option" onclick="selectAnswer(4, 5)">
                        <div class="option-number">5</div>
                        <div class="option-text">Natural gathering point, people linger</div>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button class="nav-button" onclick="previousQuestion()">Previous</button>
                    <button class="nav-button primary" onclick="nextQuestion()" id="next-4" disabled>Next</button>
                </div>
            </div>
            
            <!-- Question 5 -->
            <div class="question-container" id="q5">
                <div class="question-number">Section 5 of 5</div>
                <div class="question-category">Memorability</div>
                <div class="question-text">Could someone describe this space to a friend, or would they struggle to recall it?</div>
                <div class="options">
                    <div class="option" onclick="selectAnswer(5, 1)">
                        <div class="option-number">1</div>
                        <div class="option-text">Forgettable, hard to describe</div>
                    </div>
                    <div class="option" onclick="selectAnswer(5, 2)">
                        <div class="option-number">2</div>
                        <div class="option-text">Generic, "just a lobby"</div>
                    </div>
                    <div class="option" onclick="selectAnswer(5, 3)">
                        <div class="option-number">3</div>
                        <div class="option-text">Recognizable but not distinctive</div>
                    </div>
                    <div class="option" onclick="selectAnswer(5, 4)">
                        <div class="option-number">4</div>
                        <div class="option-text">Has memorable elements</div>
                    </div>
                    <div class="option" onclick="selectAnswer(5, 5)">
                        <div class="option-number">5</div>
                        <div class="option-text">Distinctly memorable, easy to describe</div>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button class="nav-button" onclick="previousQuestion()">Previous</button>
                    <button class="nav-button primary" onclick="showEmailGate()" id="next-5" disabled>See Results</button>
                </div>
            </div>
            
            <!-- Email Gate -->
            <div class="email-gate" id="email-gate">
                <h2>Get Your Audit Report</h2>
                <p>Enter your email to see your score and receive personalized recommendations.</p>
                <p style="font-size: 0.95rem; color: #666; margin-bottom: 2rem; max-width: 500px; margin-left: auto; margin-right: auto;">We'll also send occasional insights on placemaking and spatial psychology—no sales pitches, just ideas. Unsubscribe anytime.</p>
                <form class="email-form" onsubmit="submitResults(event)">
                    <input type="email" class="email-input" placeholder="your@email.com" required id="email-input">
                    <button type="submit" class="submit-button">Get My Score</button>
                </form>
            </div>

            <!-- Loading State -->
            <div class="loading-container" id="loading-container" style="display: none;">
                <div class="loading-text">Analyzing your responses...</div>
                <div class="loading-bar">
                    <div class="loading-progress"></div>
                </div>
            </div>

            <!-- Results -->
            <div class="results" id="results">
                <div class="score-display" id="score-display"></div>
                <div class="score-label">out of 25 points</div>
                <h2 id="results-headline"></h2>
                <div class="results-content" id="results-content"></div>

                <!-- PDF Download Button -->
                <div style="text-align: center; margin: 3rem 0 2rem;">
                    <button onclick="downloadPDF()" class="pdf-button">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Download Your Audit Report (PDF)
                    </button>
                </div>

                <!-- CTA Box -->
                <div class="cta-box" id="cta-box">
                    <h3>Next Step</h3>
                    <p>Let's talk about your space — who uses it, what's working, and what you want people to feel. I'll share initial thoughts on what's possible.</p>
                    <div class="contact-info" style="margin-bottom: 2rem;">
                        <strong>Or contact directly:</strong><br>
                        don.samec@gmail.com | +353 83 097 1140
                    </div>

                    <!-- Calendly Scheduling -->
                    <div style="margin-top: 2rem;">
                        <button onclick="showCalendly()" class="start-button" style="width: 100%; margin-bottom: 1.5rem;">
                            Book a 15-Minute Call
                        </button>

                        <div id="calendly-container" style="display: none; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-top: 1.5rem;">
                            <div class="calendly-inline-widget" data-url="https://calendly.com/donsamec/15-minutes-discovery-call?hide_event_type_details=1&hide_gdpr_banner=1&primary_color=1a1a1a" style="min-width:320px;height:700px;"></div>
                        </div>
                    </div>
                </div>
                <a href="/" class="home-link">← Back to Home</a>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        let currentQuestion = 1;
        const answers = {};
        let userEmail = '';
        let userScore = 0;
        let resultsHeadline = '';
        let resultsContent = '';
        
        function startQuiz() {
            document.getElementById('landing').style.display = 'none';
            document.getElementById('progress-container').style.display = 'block';
            document.getElementById('q1').classList.add('active');
            updateProgress();
        }
        
        function selectAnswer(questionNum, value) {
            answers[questionNum] = value;
            
            // Update UI
            const options = document.querySelectorAll(`#q${questionNum} .option`);
            options.forEach(opt => opt.classList.remove('selected'));
            event.target.closest('.option').classList.add('selected');
            
            // Enable next button
            document.getElementById(`next-${questionNum}`).disabled = false;
        }
        
        function nextQuestion() {
            document.getElementById(`q${currentQuestion}`).classList.remove('active');
            currentQuestion++;
            if (currentQuestion <= 5) {
                document.getElementById(`q${currentQuestion}`).classList.add('active');
                updateProgress();
            }
        }
        
        function previousQuestion() {
            document.getElementById(`q${currentQuestion}`).classList.remove('active');
            currentQuestion--;
            document.getElementById(`q${currentQuestion}`).classList.add('active');
            updateProgress();
        }
        
        function updateProgress() {
            const progress = (currentQuestion / 5) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            document.getElementById('progress-text').textContent = `Section ${currentQuestion} of 5`;
        }
        
        function showEmailGate() {
            document.getElementById('q5').classList.remove('active');
            document.getElementById('progress-container').style.display = 'none';
            document.getElementById('email-gate').classList.add('active');
        }
        
        async function submitResults(event) {
            event.preventDefault();

            const email = document.getElementById('email-input').value;
            const score = Object.values(answers).reduce((a, b) => a + b, 0);

            // Store globally for PDF generation
            userEmail = email;
            userScore = score;

            // Hide email gate, show loading
            document.getElementById('email-gate').classList.remove('active');
            document.getElementById('loading-container').style.display = 'block';

            // Send to Google Sheets
            const googleSheetsURL = 'https://script.google.com/macros/s/AKfycbzOITolS61Y4yNYvFvoTMG_tWsZTSWT5HBMZpooyta0nfoL7Yzo2JQZfVYKBV9KTGuh/exec';

            // Send to Mailchimp
            const mailchimpURL = 'https://donsamec.us1.list-manage.com/subscribe/post-json?u=90954a99a215ceec7843f6702&id=6a35eafac9';

            try {
                // Submit to Google Sheets immediately
                await fetch(googleSheetsURL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        timestamp: new Date().toISOString(),
                        email: email,
                        score: score,
                        q1: answers[1],
                        q2: answers[2],
                        q3: answers[3],
                        q4: answers[4],
                        q5: answers[5]
                    })
                });

                // Submit to Mailchimp using JSONP to avoid CORS - just send email
                const script = document.createElement('script');
                script.src = `${mailchimpURL}&EMAIL=${encodeURIComponent(email)}&c=mailchimpCallback`;
                document.body.appendChild(script);

                // Clean up script after it loads
                script.onload = () => {
                    setTimeout(() => document.body.removeChild(script), 100);
                };

                // Show results
                showResults(score);
            } catch (error) {
                console.error('Error submitting:', error);
                // Show results anyway
                showResults(score);
            }
        }

        // Mailchimp callback (required for JSONP)
        window.mailchimpCallback = function(data) {
            if (data.result === 'success') {
                console.log('✅ Successfully added to Mailchimp audience');
            } else {
                console.error('❌ Mailchimp error:', data.msg);
                console.log('Full response:', data);
            }
        };
        
        function showResults(score) {
            // Wait for loading animation (2s), then hide loading and show results with fade
            setTimeout(() => {
                document.getElementById('loading-container').style.display = 'none';
                const resultsEl = document.getElementById('results');
                resultsEl.classList.add('active');
                document.getElementById('score-display').textContent = score;

                // Trigger fade-in after a small delay
                setTimeout(() => {
                    resultsEl.classList.add('fade-in');
                }, 50);

            let headline, content;

            if (score >= 20) {
                headline = "Your Space Is Already Working";
                content = `
                    <p>Your space scores high on belonging — people notice it, linger in it, and can describe it to others. That's rare.</p>
                    <p>You may not need intervention. But if you're curious about opportunities to deepen what's already working — a signature piece, a subtle layer of local story, something that rewards closer attention — that's a conversation worth having.</p>
                `;
            } else if (score >= 15) {
                headline = "Solid Foundations, Missing Soul";
                content = `
                    <p>Your space functions well — clean, professional, does its job. But it doesn't stay with people. They pass through without pausing. They couldn't describe it to a friend.</p>
                    <p>This is actually a good position to be in. The bones are there. What's missing is story — something that makes the space feel specific, layered, worth a second look.</p>
                    <p>This is where material memory works best: taking a functional space and giving it texture, history, and visual depth that rewards attention.</p>
                `;
            } else if (score >= 10) {
                headline = "A Blank Canvas";
                content = `
                    <p>Your space is forgettable — but that's not a criticism. It means there's room to build something meaningful.</p>
                    <p>Right now, people move through without stopping. They don't connect with the environment or each other. The space isn't telling a story.</p>
                    <p>This is where transformation happens. Spaces in this range have the most potential for dramatic change — because there's nothing competing with the intervention. The art becomes the anchor.</p>
                    <p><strong>Example:</strong> The 450k project scored 11/25 before I started. Cold lobby, beautiful architecture, zero personality. Now it's a destination — residents pause, visitors comment, and the property manager is thrilled with the transformation.</p>
                `;
            } else {
                headline = "Starting From Zero";
                content = `
                    <p>Your space isn't connecting with anyone. It's cold, generic, and forgettable. People treat it like a corridor, not a place.</p>
                    <p>That sounds harsh, but here's the upside: you have a clean slate. There's nothing to work around, no half-measures to undo. We can build belonging from the ground up.</p>
                    <p>The question isn't "how bad is it?" — it's "what do you want people to feel when they walk in?" Welcomed? Calm? Curious? At home?</p>
                    <p>Once I understand your space and audience, I can show how layered, site-specific artwork creates the texture and story that's currently missing.</p>
                `;
            }

                // Store for PDF generation
                resultsHeadline = headline;
                resultsContent = content;

                document.getElementById('results-headline').textContent = headline;
                document.getElementById('results-content').innerHTML = content;
            }, 2000); // Wait 2s for loading animation
        }
        
        function showCalendly() {
            const container = document.getElementById('calendly-container');
            container.style.display = 'block';
            container.scrollIntoView({ behavior: 'smooth', block: 'nearest' });

            // Load Calendly script if not already loaded
            if (!document.querySelector('script[src*="calendly"]')) {
                const script = document.createElement('script');
                script.src = 'https://assets.calendly.com/assets/external/widget.js';
                script.async = true;
                document.body.appendChild(script);
            }
        }

        // PDF Download Function
        async function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            const margin = 20;
            const contentWidth = pageWidth - (margin * 2);
            let yPos = 20;

            // Header - Report Title
            doc.setFontSize(20);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(0, 0, 0);
            doc.text('Belonging Audit Report', margin, yPos);
            yPos += 8;

            // Prepared for and Date on same line
            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            doc.setTextColor(100, 100, 100);
            const dateStr = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            doc.text(`Prepared for: ${userEmail} | Date: ${dateStr}`, margin, yPos);
            yPos += 8;

            // Overall Score Section
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.text('Overall Score', margin, yPos);
            yPos += 7;

            // Score on its own line
            doc.setFontSize(24);
            doc.setFont('helvetica', 'bold');
            doc.text(`${userScore}/25`, margin, yPos);
            yPos += 12;

            // Headline on its own line below score with "Audit Result:" prefix
            doc.setFontSize(14);
            doc.text(`Audit Result: ${resultsHeadline}`, margin, yPos);
            yPos += 10;

            // Category Breakdown (single column)
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text('Category Breakdown', margin, yPos);
            yPos += 6;

            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            const categories = [
                { name: 'Visual Depth', score: answers[1] },
                { name: 'Sense of Place', score: answers[2] },
                { name: 'Emotional Temperature', score: answers[3] },
                { name: 'Dwell Behavior', score: answers[4] },
                { name: 'Memorability', score: answers[5] }
            ];

            categories.forEach(cat => {
                doc.text(`${cat.name}:`, margin, yPos);
                doc.setFont('helvetica', 'bold');
                doc.text(`${cat.score}/5`, margin + 50, yPos);
                doc.setFont('helvetica', 'normal');
                yPos += 5;
            });
            yPos += 10;

            // Analysis (single column)
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text('Analysis', margin, yPos);
            yPos += 6;

            // Extract and format content paragraphs
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = resultsContent;
            const paragraphs = Array.from(tempDiv.querySelectorAll('p')).map(p => {
                return p.textContent || p.innerText;
            });

            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');

            paragraphs.forEach(para => {
                const lines = doc.splitTextToSize(para, contentWidth);
                lines.forEach(line => {
                    doc.text(line, margin, yPos);
                    yPos += 4.5;
                });
                yPos += 6; // Space between paragraphs
            });
            yPos += 10;

            // Next Steps Section
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text('Next Steps', margin, yPos);
            yPos += 6;

            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            doc.text('Ready to transform your space?', margin, yPos);
            yPos += 5;

            doc.setFont('helvetica', 'bold');
            doc.text('Book a consultation: ', margin, yPos);
            doc.setFont('helvetica', 'normal');
            doc.setTextColor(0, 0, 200);
            doc.text('calendly.com/donsamec/15-minutes-discovery-call', margin + 33, yPos);
            doc.setTextColor(0, 0, 0);
            yPos += 5;

            doc.text('Or contact directly: don.samec@gmail.com | +353 83 097 1140', margin, yPos);
            yPos += 12;

            // Signature (if available) - flows naturally, not pinned to bottom
            try {
                const signatureImg = new Image();
                signatureImg.src = 'images/signature.png';

                await new Promise((resolve, reject) => {
                    signatureImg.onload = () => {
                        const sigWidth = 40;
                        const sigHeight = (signatureImg.height / signatureImg.width) * sigWidth;

                        doc.addImage(signatureImg, 'PNG', margin, yPos, sigWidth, sigHeight);
                        yPos += sigHeight + 4;
                        resolve();
                    };
                    signatureImg.onerror = () => {
                        // Signature not available, continue without it
                        resolve();
                    };

                    // Timeout after 1 second
                    setTimeout(() => resolve(), 1000);
                });
            } catch (e) {
                // Continue without signature if there's an error
                console.log('Signature not loaded');
            }

            // Footer
            doc.setFontSize(8);
            doc.setFont('helvetica', 'italic');
            doc.setTextColor(100, 100, 100);
            doc.text('Don Samec | Transforming Sterile Spaces into Places of Belonging', margin, yPos);
            yPos += 4;
            doc.text('donsamec.com', margin, yPos);

            // Save PDF
            doc.save(`Belonging-Audit-Report-${userScore}.pdf`);
        }
    </script>
</body>
</html>